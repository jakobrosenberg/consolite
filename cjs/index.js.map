{"version":3,"sources":["../esm/index.mjs"],"names":["defaults","filter","level","levels","error","warn","debug","trace","noop","x","unique","v","i","a","indexOf","escapeRegExp","str","replace","escapeIfString","Consolite","prefix","Proxy","_levels","ownKeys","target","Object","keys","parent","Reflect","getOwnPropertyDescriptor","key","value","enumerable","configurable","get","prop","set","createLogger","push","withinLevel","passesFilter","join","match","register","fn","defineProperty","canBind","shouldPrint","prefixes","map","p","bind","console","forEach","_level","val","_filter","root","child","assign"],"mappings":"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","sourcesContent":["/**\n * @callback Filter\n * @param {string[]} prefixes\n */\n\n/**\n * @typedef {Object} Logger\n * @prop {createLogger} create Creates new logger.\n * @prop {createLogger} createChild Creates a child logger. Prefix will be inherited. Level and levels will be inherited if undefined.\n * @prop {createLogger} createParent Creates a parent logger. Prefix will be inherited. Level and levels will be inherited if undefined.\n * @prop {Object.<string, number>} levels\n * @prop {number} level\n * @prop {Filter|string|RegExp} filter\n * @prop {Logger} root\n * @prop {Logger} parent\n */\n\nconst defaults = {\n  filter: '',\n  level: 3,\n  levels: {\n    default: 3,\n    error: 1,\n    warn: 2,\n    debug: 4,\n    trace: 4,\n  },\n}\n\nconst noop = x => x\nconst unique = (v, i, a) => a.indexOf(v) === i\n\n// $& means the whole matched string\nconst escapeRegExp = str => str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\nconst escapeIfString = str => (typeof str === 'string' ? escapeRegExp(str) : str)\n\nexport class Consolite {\n  prefix = []\n  _filter = null\n  _level = null\n  _levels = {}\n  parent = null\n\n  constructor(...prefix) {\n    this.prefix.push(...prefix)\n\n    const withinLevel = prop => this.levels[prop] <= this.level\n    const passesFilter = () =>\n      typeof this.filter === 'function'\n        ? this.filter(prefix)\n        : prefix.join('').match(escapeIfString(this.filter))\n\n    this.register = (prop, fn) =>\n      Object.defineProperty(this, prop, {\n        get: () => {\n          const canBind = typeof fn === 'function'\n          const shouldPrint = withinLevel(prop) && passesFilter() && canBind\n          const prefixes = prefix.map(p => (typeof p === 'string' ? p : p(prop, this)))\n\n          return shouldPrint ? fn.bind(console, ...prefixes) : noop\n        },\n      })\n    \n    // attach console methods\n    Object.keys(console).forEach(prop => this.register(prop, console[prop]))\n  }\n\n  get level() {\n    return this._level ?? this.parent?.level ?? defaults.level\n  }\n  set level(val) {\n    this._level = val\n  }\n  get filter() {\n    return this._filter ?? this.parent?.filter ?? defaults.filter\n  }\n  set filter(val) {\n    this._filter = val\n  }\n  get root() {\n    return this.parent?.root || this\n  }\n\n  levels = new Proxy(this._levels, {\n    ownKeys: target =>\n      [\n        ...Object.keys(defaults.levels),\n        ...Object.keys(this.parent?.levels || {}),\n        ...Reflect.ownKeys(target),\n      ].filter(unique),\n    getOwnPropertyDescriptor: (target, key) => ({\n      value: target[key],\n      enumerable: true,\n      configurable: true,\n    }),\n    get: (target, prop) =>\n      target[prop] ||\n      target.default ||\n      this.parent?.levels[prop] ||\n      this.parent?.levels.default ||\n      defaults.levels[prop] ||\n      defaults.levels.default,\n    set: (target, prop, value) => (target[prop] = value),\n  })\n\n  createChild(...prefix) {\n    const child = createLogger(...this.prefix, ...prefix)\n    child.parent = this\n    return child\n  }\n\n  createParent(...prefix) {\n    return createLogger(...prefix, ...this.prefix)\n  }\n\n  create = createLogger\n}\n\n/**\n * @callback PrefixFn\n * @param {string} method console method, eg. log, debug etc...\n */\n\n/** @typedef {Consolite & Console} ConsoliteLogger */\n\n/**\n * @param {(string|PrefixFn)[]} prefix\n * @returns {ConsoliteLogger}\n */\nexport const createLogger = (...prefix) => Object.assign(new Consolite(...prefix))\n"],"file":"index.js"}